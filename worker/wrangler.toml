name = "fund"
main = "src/index.js"
compatibility_date = "2024-12-01"

[vars]
ENVIRONMENT = "production"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "fundval-live-db"
database_id = "ddcd6031-2366-471b-9471-5c9c86f002f8"

# KV Namespace for sessions
[[kv_namespaces]]
binding = "SESSION_KV"
id = "50799695cfb144328b5a1a1806dafa11"

# Cron Triggers for scheduled tasks
[triggers]
crons = [
  "*/5 9-15 * * 1-5",   # Every 5 min during trading hours (Mon-Fri 9:00-15:59 UTC+8 â†’ adjust for UTC)
  "0 8-16 * * 1-5",     # Hourly for NAV updates and subscriptions
  "0 16 * * *",         # Daily cleanup at midnight (UTC+8 = 16:00 UTC)
]

# Static assets (frontend build) - served automatically by Cloudflare
[assets]
directory = "../frontend/dist"
binding = "ASSETS"

# SPA routing: unknown paths fall back to index.html
[assets.serve_directly]
not_found_handling = "single-page-application"
